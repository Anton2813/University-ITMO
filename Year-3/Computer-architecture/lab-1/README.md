Повышение привелегий пользователя в pkexec библиотеки polkit через передачу пустого массива аргументов программы.

Краткое повествование:
В ходе доклада будет рассказано о том, как хранится массив аргументов программы и массив переменных окружения в операционной системе GNU/Linux, а также как в библиотеке polkit, которая установлена почти на всех основных дистрибутивов Linux, при передаче в программу пустого массива аргументов (обычно первый аргумент - имя исполняемого файла, но Linux разрешает "пустой массив") до недавнего момента можно было подменить вызов функции библиотеки GNOME glib, перезаписав переменную окружения с путем до нее, и таким образом дать пользователю права root.
Чтобы минимизировать количество таких случаев, в Linux была введена концепция unsecure environment variables, которые ограничены на передачу от родительского процесса дочернему.
В связи с данной и похожими проблемами в наши дни появляется большое количество анализаторов исходных кодов, например, snyk, который может отлавливать такие уязвимости.
Мораль состоит в том, что нужно использовать такие анализаторы, а также предъявлять высокие требований к безопасности для программного обеспечения, установленного по умолчанию на основных дистрибутивах GNU/Linux.

Источники:
- https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
- https://ryiron.wordpress.com/2013/12/16/argv-silliness/
- https://github.com/PwnFunction/CVE-2021-4034
- https://gitlab.gnome.org/GNOME/glib

Вопрос:
Что такое out of bounds array read, и почему мы по неосторожности можем прочитать/записать переменные окружения вместо аргументов программы?
